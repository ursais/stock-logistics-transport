<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="view_tms_expense_line_tree" model="ir.ui.view">
        <field name="name">tms.expense.line.tree</field>
        <field name="model">tms.expense.line</field>
        <field name="priority">2</field>
        <field name="arch" type="xml">
            <tree
                decoration-info="line_type=='salary'"
                decoration-success="line_type=='fuel'"
                decoration-muted="line_type=='madeup_expense'"
                decoration-danger="amount_total&lt;0"
            >
                <field name="travel_id" readonly="1" />
                <field name="line_type" />
                <field name="product_id" />
                <field name="name" />
                <field name="product_uom_id" />
                <field name="product_qty" />
                <field name="price_unit" />
                <field name="tax_ids" widget="many2many_tags" />
                <field name="amount_subtotal" />
                <field name="tax_amount" />
                <field name="amount_total" />
                <field name="is_invoice" />
                <field name="invoice_id" />
                <!-- Field are invisible because are necessary to keep the information during edition of the record -->
                <field name="expense_id" invisible="1" />
                <field name="partner_id" invisible="1" />
                <field name="invoice_number" invisible="1" />
                <field name="date" invisible="1" />
            </tree>
        </field>
    </record>
    <record id="view_tms_expense_line_form" model="ir.ui.view">
        <field name="name">tms.expense.line.form</field>
        <field name="model">tms.expense.line</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <h2>Travel Expense Line </h2>
                    <group>
                        <field name="product_uom_id" invisible="1" />
                        <field name="expense_id" invisible="1" />
                        <field
                            name="travel_id"
                            domain="[('expense_id', '=', expense_id),('expense_id', '!=', False)]"
                            options="{'no_create': True}"
                        />
                        <field name="line_type" required='1' />
                        <field
                            name="product_id"
                            domain="[('tms_product_category', 'in', ['real_expense','salary','salary_retention','salary_discount','fuel','other_income', 'indirect_expense'])]"
                            options="{'no_create': True}"
                        />
                        <field name="name" />
                        <field
                            name="product_qty"
                            required="1"
                            attrs="{'invisible':['|', ('line_type','in', ['real_expense', 'salary', 'refund', 'salary_retention', 'salary_discount', 'other_income']), ('line_type','=', False)]}"
                        />
                        <field name='price_unit' required="1" />
                        <field
                            name='tax_ids'
                            widget='many2many_tags'
                            attrs="{'invisible':[('line_type','in', ['salary_discount', 'salary', 'salary_retention', 'other_income'])]}"
                        />
                        <field name="amount_subtotal" />
                        <field
                            name="tax_amount"
                            attrs="{'invisible':[('line_type','in', ['salary_discount', 'salary', 'salary_retention', 'other_income'])]}"
                        />
                        <field name="amount_total" required='1' />
                    </group>
                    <group
                        string="Supplier Details"
                        attrs="{'invisible':['|', ('line_type','=',False), ('line_type','in', ['salary','salary_retention','salary_discount','other_income'])]}"
                    >
                        <field
                            name="is_invoice"
                            attrs="{'invisible':['|', ('line_type','=', False), ('line_type','in',['salary','salary_retention','salary_discount','other_income', 'fuel',])]}"
                        />
                        <field
                            name="partner_id"
                            attrs="{'invisible':[('is_invoice', '=', False), ('line_type', '!=', 'fuel')],'required':['|', ('is_invoice', '=', True),('line_type', '=', 'fuel')]}"
                            widget="res_partner_many2one"
                            context="{'res_partner_search_mode': 'supplier', 'show_address': 1, 'default_is_company': True, 'show_vat': True}"
                            domain="[('is_company', '=', True)]"
                        />
                        <field
                            name="invoice_number"
                            attrs="{'invisible':[('is_invoice', '=', False), ('line_type', '!=', 'fuel')]}"
                        />
                        <field
                            name="date"
                            attrs="{'invisible':[('is_invoice', '=', False), ('line_type', '!=', 'fuel')],'required':['|', ('is_invoice', '=', True),('line_type', '=', 'fuel')]}"
                        />
                        <field
                            name="invoice_id"
                            attrs="{'invisible':['|', ('is_invoice', '=', False), ('invoice_id', '=', False)]}"
                            readonly="1"
                        />
                    </group>
                </sheet>
            </form>
        </field>
    </record>
</odoo>
