<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="fleet_vehicle_search_inherit_tms" model="ir.ui.view">
        <field name="name">fleet.vehicle.tms.search</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_search" />
        <field name="arch" type="xml">
            <xpath expr="//group" position="inside">
                <filter context="{'group_by' : 'fleet_type'}" name="groupby_fleet_type" string="Fleet Type" />
            </xpath>
        </field>
    </record>
    <record id="fleet_vehicle_form_inherit_tms" model="ir.ui.view">
        <field name="name">fleet.vehicle.tms.form</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_form" />
        <field name="priority">110</field>
        <field name="arch" type="xml">
            <xpath expr="//sheet/group/group/field[@name='driver_id']" position="after">
                <field name="fleet_type" required="1" />
            </xpath>
            <xpath expr="//label[@for='model_id']" position="before">
                <label for="economic_number" />
                <h1>
                    <field name="economic_number" placeholder="T101" required="1" />
                </h1>
            </xpath>
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_open_insurance_policy" type="object" class="oe_stat_button" icon="fa-shield">
                    <field
                        name="insurance_policy_expiration_date"
                        widget="statinfo"
                        string="Insurance"
                        attrs="{'invisible':[('policy_ids','=',[])]}"
                    />
                    <label for="policy_ids" string="Insurance" attrs="{'invisible':[('policy_ids','!=',[])]}" />
                    <field name="policy_ids" invisible="1" />
                </button>
            </xpath>
            <xpath expr="//field[@name='company_id']" position="after">
                <field
                    name="analytic_account_id"
                    groups="analytic.group_analytic_accounting"
                    attrs="{'invisible': [('fleet_type', '!=', 'tractor')]}"
                />
                <field
                    name="analytic_tag_ids"
                    widget="many2many_tags"
                    groups="analytic.group_analytic_tags"
                    attrs="{'invisible': [('fleet_type', '!=', 'tractor')]}"
                />
            </xpath>
        </field>
    </record>
    <record model='ir.ui.view' id='fleet_vehicle_tms_kanban'>
        <field name='name'>fleet_vehicle_tms_kanban</field>
        <field name='model'>fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_kanban" />
        <field name='arch' type='xml'>
            <xpath expr="//strong[hasclass('o_kanban_record_title')]" position="before">
                <t t-if="record.economic_number.raw_value">
                    <strong><field name="economic_number" /></strong><br />
                </t>
            </xpath>
            <xpath expr="//ul[1]" position="inside">
                <li>
                    <t t-if="record.fleet_type.raw_value"><field name="fleet_type" /></t>
                </li>
            </xpath>
        </field>
    </record>
    <record id="fleet_vehicle_tree_tms" model="ir.ui.view">
        <field name="name">fleet.vehicle.tms.tree</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_tree" />
        <field name="model">fleet.vehicle</field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='license_plate']" position="before">
                <field name="economic_number" />
            </xpath>
            <xpath expr="//field[@name='license_plate']" position="after">
                <field name="fleet_type" optional="show" />
            </xpath>
        </field>
    </record>
    <record id="action_fleet_vehicle_tms" model="ir.actions.act_window">
        <field name="name">Units</field>
        <field name="res_model">fleet.vehicle</field>
        <field name="view_mode">tree,form,kanban</field>
    </record>
</odoo>
